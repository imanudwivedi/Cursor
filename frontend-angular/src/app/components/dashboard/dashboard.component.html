<div class="dashboard-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="welcome-section">
        <h1 class="welcome-title">Welcome Back, {{ getUserDisplayName() }}!</h1>
      </div>
      
      <div class="header-actions">
        <button mat-stroked-button 
                class="analytics-btn"
                (click)="onNavigateToAnalytics()">
          <mat-icon>bar_chart</mat-icon>
          Analytics
        </button>
        
        <button mat-stroked-button 
                class="chat-btn"
                (click)="onToggleChatbot()">
          <mat-icon>chat</mat-icon>
          Ask RewardBot
        </button>
        
        <button mat-icon-button 
                class="settings-btn">
          <mat-icon>settings</mat-icon>
        </button>
        
        <div class="user-avatar">
          <span>{{ getUserDisplayName().charAt(0).toUpperCase() }}</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading your rewards...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && rewardData" class="main-content">
    
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card points-card">
        <div class="stat-content">
          <h2 class="stat-title">Total Reward Points</h2>
          <div class="stat-value">{{ formatPoints(rewardData.totalRewardPoints) }}</div>
          <p class="stat-subtitle">Across all cards</p>
        </div>
        <div class="stat-icon">
          <mat-icon>stars</mat-icon>
        </div>
      </div>
      
      <div class="stat-card balance-card">
        <div class="stat-content">
          <h2 class="stat-title">Total Balance</h2>
          <div class="stat-value">{{ formatCurrency(rewardData.totalBalance) }}</div>
          <p class="stat-subtitle">Available to spend</p>
        </div>
        <div class="stat-icon">
          <mat-icon>account_balance_wallet</mat-icon>
        </div>
      </div>
      
      <div class="stat-card cards-card">
        <div class="stat-content">
          <h2 class="stat-title">Active Cards</h2>
          <div class="stat-value">{{ rewardData.activeCards }}</div>
          <p class="stat-subtitle">Cards in wallet • <span class="clickable">Click to view</span></p>
        </div>
        <div class="stat-icon">
          <mat-icon>credit_card</mat-icon>
        </div>
      </div>
    </div>

    <!-- Redeem Your Points Section -->
    <div class="redemption-section">
      <h2 class="section-title">
        <mat-icon>redeem</mat-icon>
        Redeem Your Points
      </h2>
      
      <div class="redemption-grid">
        <div class="redemption-card vacation-card" (click)="onRedeemCategory('Vacation')">
          <mat-icon class="redemption-icon">flight</mat-icon>
          <span class="redemption-label">Vacation</span>
        </div>
        
        <div class="redemption-card dining-card" (click)="onRedeemCategory('Dining')">
          <mat-icon class="redemption-icon">restaurant</mat-icon>
          <span class="redemption-label">Dining</span>
        </div>
        
        <div class="redemption-card shopping-card" (click)="onRedeemCategory('Shopping')">
          <mat-icon class="redemption-icon">shopping_bag</mat-icon>
          <span class="redemption-label">Shopping</span>
        </div>
        
        <div class="redemption-card general-card" (click)="onRedeemCategory('General')">
          <mat-icon class="redemption-icon">star</mat-icon>
          <span class="redemption-label">General</span>
        </div>
      </div>
    </div>

    <!-- Your Cards Section -->
    <div class="cards-section">
      <h2 class="section-title">Your Cards</h2>
      
      <div class="cards-grid">
        <div *ngFor="let card of rewardData.cards" class="reward-card">
          <div class="card-header">
            <div class="card-vendor">{{ card.vendorName }}</div>
            <div class="card-type">{{ card.cardType }}</div>
          </div>
          
          <div class="card-number">{{ card.maskedCardNumber }}</div>
          
          <div class="card-stats">
            <div class="card-stat">
              <span class="stat-label">Balance</span>
              <span class="stat-value">{{ formatCurrency(card.cardBalance) }}</span>
            </div>
            
            <div class="card-stat">
              <span class="stat-label">Cashback</span>
              <span class="stat-value">{{ card.cashbackRate }}%</span>
            </div>
          </div>
          
          <div class="card-points">
            <div class="points-info">
              <span class="points-value">{{ formatPoints(card.totalRewardPoints) }}</span>
              <span class="points-label">Reward Points</span>
            </div>
            
            <div *ngIf="card.expiringSoonPoints > 0" class="expiring-warning">
              ⚠️ {{ formatPoints(card.expiringSoonPoints) }} expiring soon
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Bot Overlay -->
  <div *ngIf="showChatbot" class="chatbot-overlay" (click)="showChatbot = false">
    <div class="chatbot-container" (click)="$event.stopPropagation()">
      <app-chat></app-chat>
    </div>
  </div>
</div> 